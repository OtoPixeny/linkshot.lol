# Avatar URL Sync Feature

## აღწერა
ამ ფუნქციონალმა დაამატა `avatar_url` სვეტი მომხმარებლების ცხრილში და ავტომატურად სინქრონიზდებს Clerk-ის ავატარის URL-ს.

## ცვლილებები

### 1. მონაცემთა ბაზა
- **ფაილი:** `supabase-avatar-migration.sql`
- **ცვლილება:** დაემატა `avatar_url TEXT` სვეტი `users` ცხრილში
- **ინდექსი:** შეიქმნა ინდექსი სწრაფი მოთხოვნებისთვის

### 2. Backend (UserModel)
- **ფაილი:** `src/models/user.js`
- **ახალი მეთოდი:** `syncAvatarUrl(userId, avatarUrl)` - ავტომატური სინქრონიზაციისთვის
- **განახლება:** `columnMapping`-ში დაემატა `avatar_url` მხარდაჭერა

### 3. Frontend Hook
- **ფაილი:** `src/hooks/useAvatarSync.js`
- **ფუნქციონალი:** ყოველ 5 წამში ამოწმებს Clerk-ის ავატარის URL-ს და ახდენს სინქრონიზაციას
- **ოპტიმიზაცია:** მხოლოდ მაშინ ახდენს განახლებას, როცა URL იცვლება

### 4. კომპონენტები
- **ManageForm:** გამოიყენებს `useAvatarSync` ჰუკს და ამატებს `avatar_url`-ს პროფილის განახლებისას
- **UserSocials:** გამოიყენებს `avatar_url`-ს ავატარის საჩვენებლად

## ინსტალაცია

### 1. მონაცემთა ბაზის მიგრაცია
```sql
-- გაუშვით ეს მიგრაცია Supabase-ში
ALTER TABLE users ADD COLUMN avatar_url TEXT;
CREATE INDEX idx_users_avatar_url ON users(avatar_url);
COMMENT ON COLUMN users.avatar_url IS 'URL of the user''s avatar image from Clerk';
```

### 2. აპლიკაციის გაშვება
ფაილები უკვე განახლებულია. უბრალოდ გაუშვით აპლიკაცია.

## როგორ მუშაობს

1. **ავტომატური სინქრონიზაცია:** როცა მომხმარებელი შედის Dashboard-ზე, `useAvatarSync` ჰუკი ყოველ 5 წამში ამოწმებს Clerk-ის ავატარის URL-ს
2. **განახლება:** თუ URL შეცვლილა, ავტომატურად განახლდება მონაცემთა ბაზაში
3. **ჩვენება:** UserSocials გვერდზე გამოჩნდება სინქრონიზირებული ავატარი
4. **სარეზერვო:** თუ სურათი ვერ იტვირთება, გამოჩნდება მომხმარებლის ინიციალები

## უპირატესობები

- ✅ ავტომატური სინქრონიზაცია Clerk-თან
- ✅ რეალურ დროში განახლება
- ✅ ოპტიმიზირებული შესრულება (მხოლოდ ცვლილებისას)
- ✅ სარეზერვო ვარიანტები
- ✅ მხარდაჭერა ძველი `image` სვეტისთვის
